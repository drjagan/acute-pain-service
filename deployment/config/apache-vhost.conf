<VirtualHost *:80>
    ServerName your-domain.com
    ServerAlias www.your-domain.com
    ServerAdmin admin@your-domain.com
    
    DocumentRoot /var/www/acute-pain-service/public
    
    <Directory /var/www/acute-pain-service/public>
        Options -Indexes +FollowSymLinks
        AllowOverride All
        Require all granted
        
        # Enable rewrite engine
        RewriteEngine On
        
        # Redirect to index.php if file doesn't exist
        RewriteCond %{REQUEST_FILENAME} !-f
        RewriteCond %{REQUEST_FILENAME} !-d
        RewriteRule ^(.*)$ index.php [QSA,L]
    </Directory>
    
    # Deny access to sensitive directories
    <DirectoryMatch "^/.*/\.(git|svn|htaccess)">
        Require all denied
    </DirectoryMatch>
    
    <Directory /var/www/acute-pain-service/config>
        Require all denied
    </Directory>
    
    <Directory /var/www/acute-pain-service/src>
        Require all denied
    </Directory>
    
    # Security Headers
    Header always set X-Frame-Options "SAMEORIGIN"
    Header always set X-Content-Type-Options "nosniff"
    Header always set X-XSS-Protection "1; mode=block"
    Header always set Referrer-Policy "strict-origin-when-cross-origin"
    
    # Logging
    ErrorLog ${APACHE_LOG_DIR}/aps-error.log
    CustomLog ${APACHE_LOG_DIR}/aps-access.log combined
    
    # PHP Configuration
    php_value upload_max_filesize 10M
    php_value post_max_size 10M
    php_value memory_limit 256M
    php_value max_execution_time 300
    php_flag display_errors Off
    php_flag log_errors On
    php_value error_log /var/log/aps/php-errors.log
</VirtualHost>

# SSL Configuration (Recommended - use after obtaining SSL certificate)
# <VirtualHost *:443>
#     ServerName your-domain.com
#     ServerAlias www.your-domain.com
#     ServerAdmin admin@your-domain.com
#     
#     DocumentRoot /var/www/acute-pain-service/public
#     
#     <Directory /var/www/acute-pain-service/public>
#         Options -Indexes +FollowSymLinks
#         AllowOverride All
#         Require all granted
#     </Directory>
#     
#     # SSL Configuration
#     SSLEngine on
#     SSLCertificateFile /etc/ssl/certs/your-domain.crt
#     SSLCertificateKeyFile /etc/ssl/private/your-domain.key
#     SSLCertificateChainFile /etc/ssl/certs/chain.crt
#     
#     # Security Headers
#     Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains"
#     Header always set X-Frame-Options "SAMEORIGIN"
#     Header always set X-Content-Type-Options "nosniff"
#     
#     ErrorLog ${APACHE_LOG_DIR}/aps-ssl-error.log
#     CustomLog ${APACHE_LOG_DIR}/aps-ssl-access.log combined
# </VirtualHost>
